# AGENTS.md - Shep Style Guide
# Generated by `shep style` command
# Based on Evil Martians' vibe coding methodology

## Project Context

This is the **SupportAI** application, built with the Shep language.

Shep generates:
- **Python** (FastAPI, Pydantic) for the backend
- **TypeScript** (React, Next.js) for the frontend
- **SQL** (PostgreSQL) for the database

## Core Principles

Follow the Golden Sheep AI Methodology:
1. **Vertical Slice Delivery** - Build complete features end-to-end
2. **Full-Stack Reality Testing** - Test everything the way users experience it
3. **Integration-First Verification** - If it compiles, it works
4. **AI as First-Class Citizen** - AI is a verb, not an integration

## Domain Language

Use domain-specific terms, not generic technical names:

- `CompanyPlan`
- `ConversationStatus`
- `MessageRole`
- `Company`
- `KnowledgeBase`
- `Conversation`
- `Message`
- `Escalation`

**Bad:** `User`, `Data`, `Item`, `Thing`
**Good:** Use terms from your business domain (e.g., `Founder`, `Investor`, `Ticket`, `Escalation`)

## Naming Conventions

### Python
- snake_case for Python variables/functions

### TypeScript
- camelCase for TypeScript variables/functions

## Structure Patterns

### Optional for nullable fields
```
// Pattern detected - add example here
```

### TypeScript interfaces/types
```
// Pattern detected - add example here
```

### React hooks
```
// Pattern detected - add example here
```

### custom hooks pattern (useXxx)
```
// Pattern detected - add example here
```

### Pydantic BaseModel for data classes
```
// Pattern detected - add example here
```

### Python Enum for state
```
// Pattern detected - add example here
```

### FastAPI router decorators
```
// Pattern detected - add example here
```


## AI Patterns

- Uses async/await for AI calls
- Uses centralized AI client pattern
- Implements AI response caching

### AI Field Pattern
```shep
entity Message:
  fields:
    - sentiment: ai("classify as positive, neutral, or negative")
```

Generates:
```python
async def compute_message_sentiment(data: dict) -> str:
    return await call_ai(
        prompt="Classify the following text as positive, neutral, or negative",
        context=data.get("content", ""),
        cache_key="message_sentiment"
    )
```

### AI Rule Pattern
```shep
rule "Auto-escalate frustrated customers":
  if ai(message.content, "sounds frustrated") → escalate
```

Generates a boolean-returning AI function that can be called from routes.

## Anti-Patterns (Avoid)

- ❌ Fat models with business logic
- ❌ Generic names like `User`, `Data`, `Handler`
- ❌ Mocked AI responses in production code
- ❌ Hardcoded API keys
- ❌ Synchronous AI calls (always use async)
- ❌ String types for states (use enums)
- ❌ Inline styles in React (use component patterns)

## File Organization

```
generated/
├── models.py          # Pydantic models (data layer)
├── routes.py          # FastAPI routes (API layer)
├── ai_client.py       # AI integration (Claude/OpenAI)
├── main.py            # FastAPI entry point
├── types.ts           # TypeScript interfaces
├── api.ts             # API client
├── hooks.ts           # React hooks
├── ai.ts              # Frontend AI client
└── schema.sql         # PostgreSQL schema
```

## Error Handling

### Python
```python
@router.post("/ai/{endpoint}")
async def ai_endpoint(data: dict):
    try:
        result = await call_ai(...)
        return {"result": result}
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))
```

### TypeScript
```typescript
const { data, loading, error } = useQuery<T>(endpoint);
if (error) return <ErrorState message={error.message} />;
if (loading) return <LoadingState />;
```

## Testing Requirements

Every feature must pass:
1. ✅ Unit tests for business logic
2. ✅ Integration tests for API endpoints
3. ✅ AI response validation (schema checks)
4. ✅ E2E tests for user flows
5. ✅ Deployment verification

---

*Generated by Shep Compiler - Golden Sheep AI Methodology*
*"Build narrow. Test deep. Ship confidently."*
